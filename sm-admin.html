<html><head><meta charset="UTF-8"><link rel="import" href="../simpla-block/simpla-block.html"><link rel="import" href="../sm-ui-toolbar/sm-ui-toolbar.html"><link rel="import" href="../sm-utility-share/sm-utility-share.html"><link rel="import" href="../sm-utility-auth/sm-utility-auth.html"><link rel="import" href="../sm-module-notify/sm-module-notify.html"><link rel="import" href="../sm-module-save/sm-module-save.html"><link rel="import" href="../sm-module-login/sm-module-login.html"><link rel="import" href="../simpla-core/simpla-core.html"><link rel="import" href="../polymer/polymer.html"></head><body><dom-module id="sm-admin">
  <template>
    <style include="sm-css"></style>
    <style>:host *{z-index:var(--on-top)}.save{position:fixed;top:12px;right:12px}</style>

    <template is="dom-if" if="{{_edit}}" restamp="">
      <template is="dom-if" if="{{_notAuthenticated}}" restamp="">
        <sm-module-login id="login" class="login"></sm-module-login>
      </template>

      <template is="dom-if" if="{{_authenticated}}" restamp="">
        <sm-module-save id="save" class="save"></sm-module-save>
      </template>
    </template>

    <sm-ui-toolbar id="toolbar" hidden="{{!_edit}}"></sm-ui-toolbar>

    <sm-module-notify id="notify" class="notify"></sm-module-notify>
    <sm-utility-auth id="auth" token="{{_token}}" authenticated="{{_authenticated}}"></sm-utility-auth>
    <sm-utility-share type="state" key="editable" value="{{_editable}}"></sm-utility-share>
    <sm-utility-share type="singletons" key="toolbar" value="{{_toolbar}}"></sm-utility-share>
  </template>
  <script>!function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(3)},function(e,t){"use strict";function n(e){e.stopPropagation()}function i(e){c.forEach(function(t){return e.addEventListener(t,n)}),e._restoreEvents=function(){c.forEach(function(t){return e.removeEventListener(t,n)})}}function o(e,t){for(var n=function(e){return 0!==e.querySelectorAll(d).length},i=function(e){return!!e.localName.match(/simpla-*|sm-/)},o=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,function(e){return i(e)?NodeFilter.FILTER_REJECT:n(e)?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}),a=void 0;a=o.nextNode();)t(a)}function a(e){e.style.pointerEvents="none"}function r(e){e.style.pointerEvents=""}function u(e){return[].slice.call(e.querySelectorAll(s))}Object.defineProperty(t,"__esModule",{value:!0});var c=["tap","mouseup","mousedown","click","touchup","touchdown"],s="simpla-img, simpla-text",d="simpla-img, simpla-text, sm-admin";t["default"]={properties:{_clicksDisabled:{type:Boolean,value:!1}},observers:["_shouldDisableClicks(_edit, _clicksDisabled)"],_disableClickEvents:function(e){var t=u(e);t.forEach(i),o(e,a),this._clicksDisabled=!0},_enableClickEvents:function(e){var t=u(e);t.forEach(function(e){return e._restoreEvents()}),o(e,r),this._clicksDisabled=!1},_shouldDisableClicks:function(e,t){var n=document.body;e&&!t?this._disableClickEvents(n):!e&&t&&this._enableClickEvents(n)}},e.exports=t["default"]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={ready:function(){var e=this;window.simpla=window.simpla||{},window.simpla.editMode=function(t){var n=t?window.removeEventListener:window.addEventListener;e._edit=t,n("hashchange",e._updateEditFromHash)}}},e.exports=t["default"]},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(){var e=void 0,t=void 0,n=void 0;e=document.body,n=document.createElement("sm-block-namespace"),n.uid=simpla.config.baseurl.replace(".","\\."),n.block=e,t=document.createElement("sm-admin"),e.appendChild(t)}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(1),c=(i(u),n(2)),s=i(c),d="edit",l=function(){function e(){o(this,e)}return r(e,[{key:"beforeRegister",value:function(){this.is="sm-admin",this.properties={_authenticated:{type:Boolean,observer:"_authenticatedChanged"},_notAuthenticated:{type:Boolean,computed:"_computeNotAuthenticated(_authenticated)",value:!0},_edit:{type:Boolean,value:!1},_editable:Boolean,_token:String},this.observers=["_updateEditable(_authenticated, _edit)"]}},{key:"ready",value:function(){var e=this;this._updateEditFromHash=function(){e._edit=window.location.hash.split("#").pop()===d};var t=void 0;window.simpla=window.simpla||{},window.simpla.notifications=this.$.notify,window.addEventListener("hashchange",this._updateEditFromHash),this._toolbar=this.$.toolbar,this._updateEditFromHash(),this._token=window.localStorage.getItem("sm-token"),t=document.createElement("sm-meta-data"),t.block=document.body,t.uid=encodeURIComponent(simpla.config.baseurl+window.location.pathname)}},{key:"_computeNotAuthenticated",value:function(e){return!e}},{key:"_updateEditable",value:function(e,t){this._editable=e&&t}},{key:"_authenticatedChanged",value:function(e,t){t&&!e&&(window.location.hash=""),e&&this.fire("logged-in")}},{key:"behaviors",get:function(){return[s["default"]]}}]),e}();"complete"===document.readyState||"interactive"===document.readyState?a():document.addEventListener("DOMContentLoaded",a),Polymer(l)}]);</script>
</dom-module>
</body></html>